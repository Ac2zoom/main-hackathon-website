<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HackingEDU | World's Largest Education Hackathon</title>
    <link rel="icon" href="img/favicon.ico">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link href="css/normalize.css" rel="stylesheet">
    <link href="css/skeleton.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>
    <link href="css/style.css" rel="stylesheet">
  </head>
  <body background="img/signupprism.png">
    <div class="container-fluid">
      <form id="signup_form" class="col-md-offset-3">
        <div class="col-md-7">
          <h2>Account Info</h2>
          <!--
          Below we include the Login Button social plugin. This button uses
          the JavaScript SDK to present a graphical Login button that triggers
          the FB.login() function when clicked.
          -->
          <div class="fb-login-button" data-max-rows="1" data-size="xlarge" data-show-faces="false" data-auto-logout-link="true"></div>
          <!-- <fb:login-button scope="public_profile,email" onlogin="checkLoginState();"></fb:login-button> -->

          <div class="form-group">
            <label for="firstname">First Name</label>
            <input type="text" class="form-control" id="firstname" name="firstname" placeholder="Hacker">
          </div>

          <div class="form-group">
            <label for="lastname">Last Name</label>
            <input type="text" class="form-control" id="lastname" name="lastname" placeholder="McHackerton">
          </div>

          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" class="form-control" id="email" name="email" placeholder="you@youremail.com">
          </div>

          <div class="form-group">
            <label for="phone">Phone #</label>
            <input type="text" class="form-control" id="phone" name="phone" placeholder="5555555555">
          </div>

          <div class="form-group">
            <label for="password">Password</label>
            <input type="password" class="form-control" id="password" name="password">
          </div>

          <div class="form-group">
            <label for="confirm_password">Confirm Password</label>
            <br><input type="password" class="form-control" id="confirm_password" name="confirm_password">
          </div>

          <hr>

          <h2>Location</h2>
          <div class="form-group">
            <label for="street">Street Address</label>
            <input type="text" class="form-control" id="street" name="street">
          </div>

          <div class="form-inline">
            <div class="form-group">
              <label for="city">City</label>
              <input type="text" class="form-control" id="city" name="city">
            </div>

            <div class="form-group">
              <label for="state">State</label>
              <input type="text" class="form-control" id="state" name="state">
            </div>

            <div class="form-group">
              <label for="zip">Zip</label>
              <input type="text" class="form-control" id="zip" name="zip">
            </div>
          </div>

          <hr>

          <h2>School & Experience</h2>
          <div class="form-group">
            <label for="school">School</label>
            <input type="text" class="form-control" name="school" id="school">
          </div>

          <div class="form-group">
            <label for="dob">Date of Birth (DD/MM/YYYY)</label>
            <input type="text" class="form-control" name="dob" id="dob" placeholder="01/13/1997">
          </div>

          <div class="form-group">
            <label for="linkedin">LinkedIn URL</label>
            <input type="text" class="form-control" name="linkedin" id="linkedin">
          </div>

          <div class="form-group">
            <label for="github">Github URL</label>
            <input type="text" class="form-control" name="github" id="github">
          </div>

          <div class="form-group">
            <label for="resume">Resume/CV (.pdf, .doc, .docx)</label>
            <input type="file" accept=".doc,.docx,.pdf" name="resume" id="resume">
          </div>

          <div class="form-inline">
            <label>Interested in a job in Tech?</label>

            <select name="job" class="form-control" id="job">
              <option></option>
              <option value="yes">Yes</option>
              <option values="no">No</option>
            </select>
          </div>

          <hr>

          <h2>About You</h2>
          <div class="form-inline">
            <label>Gender</label>
            <select class="form-control" name="gender">
              <option value=""></option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="none">Decline to state</option>
            </select>
          </div>

          <br>

          <div class="form-inline">
            <label>Have you been to a hackathon before?</label>
            <select class="form-control" name="veteran">
              <option value=""></option>
              <option value="yes">Yes</option>
              <option value="no">No</option>
            </select>
          </div>

          <br>

          <div class="form-group">
            <label>What type of hacker are you? (check all that apply)</label>
            <div class="checkbox">
              <label for="hacker_designer">
                <input type="checkbox" name="hacker" value="designer" id="hacker_designer">Designer
              </label>
              <label for="hacker_developer">
                <input type="checkbox" name="hacker" value="developer" id="hacker_developer">Developer
              </label>
              <label for="hacker_product">
                <input type="checkbox" name="hacker" value="product" id="hacker_product">Product
              </label>
              <label for="hacker_web">
                <input type="checkbox" name="hacker" value="web" id="hacker_web">Web
              </label>
              <label for="hacker_ios">
                <input type="checkbox" name="hacker" value="ios" id="hacker_ios">iOS
              </label>
              <label for="hacker_android">
                <input type="checkbox" name="hacker" value="android" id="hacker_android">Android
              </label>
              <label for="hacker_hardware">
                <input type="checkbox" name="hacker" value="hardware" id="hacker_hardware">Hardware
              </label>
          </div>

          <div class="form-group">
            <label>Shirt Size</label>
            <select class="form-control" name="shirt" id="shirt">
              <option value=""></option>
              <option value="S">S</option>
              <option value="M">M</option>
              <option value="L">L</option>
              <option value="XL">XL</option>
            </select>
          </div>

          <div class="form-inline">
            <label>Will you need transportation? (Bus)</label>
            <select class="form-control" name="bus" id="bus">
              <option value=""></option>
              <option value="yes">Yes</option>
              <option value="no">No</option>
            </select>
          </div>

          <br>

          <div class="form-inline">
            <label>Dietary Restrictions</label>
            <select class="form-control" name="diet">
              <option value="none">None</option>
              <option value="vegetarian">Vegetarian</option>
              <option value="vegan">Vegan</option>
              <option value="gluten free">Gluten Free</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <div class="checkbox">
            <label for="tos">
              <input type="checkbox" name="tos" id="tos">I agree to the <a href="https://drive.google.com/a/thekao.com/file/d/0BzF-e8GGV_UiOThlSGcxU01lWG8/view?pli=1" target="_blank"> Terms of Service
              </a>
            </label>
          </div>
        </div>
        <input type="submit" value="Apply" style="width: 100%;">
      </form>
    </div>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script>
    // This is called with the results from from FB.getLoginStatus().
    function statusChangeCallback(response) {
      console.log('statusChangeCallback');
      console.log(response);
      // The response object is returned with a status field that lets the
      // app know the current login status of the person.
      // Full docs on the response object can be found in the documentation
      // for FB.getLoginStatus().
      if (response.status === 'connected') {
        // Logged into your app and Facebook.
        testAPI();
      } else if (response.status === 'not_authorized') {
        // The person is logged into Facebook, but not your app.
        document.getElementById('status').innerHTML = 'Please log ' +
          'into this app.';
      } else {
        // The person is not logged into Facebook, so we're not sure if
        // they are logged into this app or not.
        document.getElementById('status').innerHTML = 'Please log ' +
          'into Facebook.';
      }
    }

    // This function is called when someone finishes with the Login
    // Button.  See the onlogin handler attached to it in the sample
    // code below.
    function checkLoginState() {
      FB.getLoginStatus(function(response) {
        statusChangeCallback(response);
      });
    }

    window.fbAsyncInit = function() {
      FB.init({
        appId      : '1541408916127520',
        cookie     : true,  // enable cookies to allow the server to access
                            // the session
        xfbml      : true,  // parse social plugins on this page
        version    : 'v2.3' // use version 2.2
      });

      // Now that we've initialized the JavaScript SDK, we call
      // FB.getLoginStatus().  This function gets the state of the
      // person visiting this page and can return one of three states to
      // the callback you provide.  They can be:
      //
      // 1. Logged into your app ('connected')
      // 2. Logged into Facebook, but not your app ('not_authorized')
      // 3. Not logged into Facebook and can't tell if they are logged into
      //    your app or not.
      //
      // These three cases are handled in the callback function.

      FB.getLoginStatus(function(response) {
        statusChangeCallback(response);
      });
    };

    // Load the SDK asynchronously
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/sdk.js";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    // Here we run a very simple test of the Graph API after login is
    // successful.  See statusChangeCallback() for when this call is made.
    function testAPI() {
      console.log('Welcome!  Fetching your information.... ');
      FB.api('/me', function(response) {
        console.log('Successful login for: ' + response.name);
        document.getElementById('status').innerHTML =
          'Thanks for logging in, ' + response.name + '!';
      });
    }

    FB.getLoginStatus(function(response) {
      if (response.status === 'connected') {
        console.log(response.authResponse.accessToken);
      }
    });

    FB.api(
    {
      method: 'fql.query',
      query: 'SELECT first_name, last_name, email FROM user WHERE uid= ' + response.authResponse.userID}, function (data) {
      if (data && data[0]) {
        if (data[0].first_name) {
          document.getElementById('firstname').value = data[0].first_name;
        } if (data[0].last_name) {
          document.getElementById('lastname').value = data[0].last_name;
        } if (data[0].email) {
          document.getElementById('email').value = data[0].email;
        }
      }
    });
  </script>

  <script>
    $('#signup_form').on('submit', function(event) {
      event.preventDefault();

      if ($("input[name='password']").val() !== $("input[name='confirm_password']").val()) {
        alert('Those passwords don\'t match.');
        return false;
      }

      if (!$("input[name='tos']").prop('checked')) {
        alert('You must agree to the Terms of Service to sign up.');
        return false;
      }

      sendForm();
    });


    var sendForm = function() {
      $.ajax('/new_user', {
          type: 'POST',
          datatype: 'json',
          data: $('#signup_form').serialize(),
          success: signupSuccess,
          error: signupFail
      });
    }

    var signupSuccess = function(result) {
      alert(result.msg);
      console.log(result);
    }

    var signupFail = function(result) {
      alert(result.msg);
      console.log(result);
    }
  </script>
  </body>
</html>
